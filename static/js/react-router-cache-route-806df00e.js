import{k as e,h as t}from"./@babel-9fa0b289.js";import{r}from"./react-78128977.js";import{r as n}from"./mini-create-react-context-da742c12.js";import{p as o}from"./prop-types-5e56cc5e.js";import{r as c}from"./react-router-dom-742b2f03.js";var a={exports:{}},i={exports:{}};!function(t,r,n,o,c){function a(e){return void 0===e}function i(e){return null===e}function u(e){return"number"==typeof e&&!m(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s="default"in r?r.default:r,h=(n=n&&n.hasOwnProperty("default")?n.default:n,o=o&&o.hasOwnProperty("default")?o.default:o,function(e){return"function"==typeof e}),f=function(e){return"string"==typeof e},p=function(e){return!(a(e)||i(e))},d=function(e){return e instanceof Array},m=function(e){return e!=e},y=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],r=arguments[2];try{u(t)&&(t=String(t));var n=(f(t)?t.split("."):t).reduce((function(e,t){return e[t]}),e);return a(n)?r:n}catch(o){return r}},v=function(e){for(var t=arguments.length,r=Array(2<t?t-2:0),n=2;n<t;n++)r[n-2]=arguments[n];var o=f(o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[])?o.split("."):o,c=y(e,o);return e=y(e,o.slice(0,-1)),h(c)?c.call.apply(c,[e].concat(r)):c},_=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce((function(e,t){return a(e)?v(t):v(e)}),void 0)},b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w=function(e,t,r){return t&&g(e.prototype,t),r&&g(e,r),e};function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function j(e,t){var r,n={};for(r in e)0<=t.indexOf(r)||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function E(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}function P(e){return e.reduce((function(e,t){return[].concat(k(e),k(d(t)?P(t):[t]))}),[])}function S(e){var t,r=[];for(t in e)r.push(e[t]);return r}var R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},T=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=t,n=[],o=!0,c=void(t=!1);try{for(var a,i=e[Symbol.iterator]();!(o=(a=i.next()).done)&&(n.push(a.value),!r||n.length!==r);o=!0);}catch(u){t=!0,c=u}finally{try{!o&&i.return&&i.return()}finally{if(t)throw c}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},k=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},L=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw new Error("unable to locate global object")}(),x="object"===(void 0===e?"undefined":b(e))&&e&&e.Math===Math&&e.Array===Array?e:L,A=y(x,"document.body"),M=y(x,"document.scrollingElement",y(x,"document.documentElement",{}));function N(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return!!p(e)&&(e.scrollWidth>e.clientWidth||e.scrollHeight>e.clientHeight)}function z(e){return h(y(x,"document.getElementById"))?[].concat(k(_(v(e,"querySelectorAll","*"),[])),[e]).filter(N):[]}function D(){return Object.entries(W).filter((function(e){return(e=T(e,2)[1])instanceof Z?e.state.cached:Object.values(e).some((function(e){return e.state.cached}))}))}function F(){return R({},W)}function K(e,t){W[e]=t}function U(e){delete W[e]}function q(e){return v(e,"reset")}function B(e){(e=y(W,[e]))&&(e instanceof Z?q(e):Object.values(e).forEach(q))}function H(e){return v(e,"refresh")}var W={},V=n(),I=V.Provider;function X(e,t){var n,o;h(r.useContext)&&((n=r.useRef((function(){return null}))).current=t,o=r.useContext(V),r.useEffect((function(){var t=v(o,"on",e,(function(){v(n.current)}));return function(){return v(t)}}),[]))}function G(e,t){var r=e.match,n=void 0===(n=e.when)?"forward":n;if(Y(r)||(r=null),!t.cached&&r)return{cached:!0,matched:!0};if(t.matched&&!r){var o=y(e,"history.action"),c=!1;if(h(n))c=!n(e);else switch(n){case"always":break;case"back":["PUSH","REPLACE"].includes(o)&&(c=!0);break;default:"POP"===o&&(c=!0)}if(c)return{cached:!1,matched:!1}}return{matched:!!r}}V.Consumer,b=X.bind(null,"didCache"),L=X.bind(null,"didRecover");var J=p(s.forwardRef),Q="__isComputedUnmatch",Y=function(e){return p(e)&&!0!==y(e,Q)},Z=(O($,n=r.Component),w($,[{key:"componentDidUpdate",value:function(e,t){if(t.cached&&this.state.cached)return!0===t.matched&&!1===this.state.matched?(this.props.unmount&&this.ejectDOM(),this.__cacheUpdateTime=Date.now(),S(this.cacheLifecycles.__didCacheListener).forEach((function(e){v(e)})),v(this,"cacheLifecycles.__listener.didCache")):!1===t.matched&&!0===this.state.matched?(this.props.saveScrollPosition&&v(this.__revertScrollPos),this.__cacheUpdateTime=Date.now(),S(this.cacheLifecycles.__didRecoverListener).forEach((function(e){v(e)})),v(this,"cacheLifecycles.__listener.didRecover")):void 0}},{key:"shouldComponentUpdate",value:function(e,t){var r,n=!1===this.state.matched&&!0===t.matched,o=!0===this.state.cached&&!1===t.cached;return(t=this.state.matched||t.matched||this.state.cached!==t.cached)&&((this.props.unmount&&o||n)&&this.injectDOM(),o||n||!this.props.saveScrollPosition||(this.__revertScrollPos=(o=this.props.unmount?this.wrapper:void 0,r=[].concat(k(new Set([].concat(k(P((d(o)?o:[o]).map(z))),k([M,A].filter(N)))))).map((function(e){return[e,{x:e.scrollLeft,y:e.scrollTop}]})),function(){r.forEach((function(e){var t=(e=T(e,2))[0],r=(e=e[1]).x;e=e.y,t.scrollLeft=r,t.scrollTop=e}))}))),t}},{key:"componentWillUnmount",value:function(){var e=(r=this.props).unmount,t=r.href,r=r.multiple,n=v(this.props,"cacheKey",this.props);r?(delete(r=R({},F()[n]))[t],0===Object.keys(r).length?U(n):K(n,r)):U(n),e&&this.injectDOM()}},{key:"render",value:function(){var e=this,t=(n=this.state).matched,r=n.cached,n=n.key,o=void 0===(o=(a=this.props).className)?"":o,c=a.behavior,a=a.children;return t=void 0===(t=(c=_(v(c,void 0,!t),{})).className)?"":t,c=j(c,["className"]),o=v(o+" "+t,"trim"),r?s.createElement("div",R({key:n,className:""!==o?o:void 0},c,{ref:function(t){e.wrapper=t}}),s.createElement(I,{value:this.cacheLifecycles},v(a,void 0,this.cacheLifecycles))):null}}]),$);function $(e){l(this,$);for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o,c,a=E(this,(o=$.__proto__||Object.getPrototypeOf($)).call.apply(o,[this,e].concat(r)));return a.cacheLifecycles={__listener:{},__didCacheListener:{},__didRecoverListener:{},on:function(e,t){var r=Math.random(),n="__"+e+"Listener";return a.cacheLifecycles[n][r]=t,function(){delete a.cacheLifecycles[n][r]}},didCache:function(e){a.cacheLifecycles.__listener.didCache=e},didRecover:function(e){a.cacheLifecycles.__listener.didRecover=e}},a.componentWillReceiveProps=J?void 0:function(e){e=G(e,a.state),a.setState(e)},a.injectDOM=function(){try{v(a.__parentNode,"insertBefore",a.wrapper,a.__placeholderNode),v(a.__parentNode,"removeChild",a.__placeholderNode)}catch(e){}},a.ejectDOM=function(){try{var e=y(a.wrapper,"parentNode");a.__parentNode=e,v(a.__parentNode,"insertBefore",a.__placeholderNode,a.wrapper),v(a.__parentNode,"removeChild",a.wrapper)}catch(t){}},a.reset=function(){delete a.__revertScrollPos,a.setState({cached:!1})},a.refresh=function(){delete a.__revertScrollPos,a.setState({key:Math.random()})},a.__cacheCreateTime=Date.now(),a.__cacheUpdateTime=a.__cacheCreateTime,e.cacheKey&&(o=v(e.cacheKey,void 0,e),e.multiple?(c=e.href,K(o,R({},F()[o],C({},c,a)))):K(o,a)),"undefined"!=typeof document&&(c=v(e.cacheKey,void 0,e),a.__placeholderNode=document.createComment(" Route cached "+(c?'with cacheKey: "'+c+'" ':""))),a.state=G(e,{cached:!1,matched:!1,key:Math.random()}),a}Z.__name="CacheComponent",Z.propsTypes={history:o.object.isRequired,match:o.object.isRequired,children:o.func.isRequired,className:o.string,when:o.oneOfType([o.func,o.oneOf(["forward","back","always"])]),behavior:o.func,unmount:o.bool,saveScrollPosition:o.bool},Z.defaultProps={when:"forward",unmount:!1,saveScrollPosition:!1,behavior:function(e){return e?{style:{display:"none"}}:void 0}},Z.getDerivedStateFromProps=J?G:void 0;var ee=!(h(r.lazy)&&!a(r.Suspense)),te=(O(re,n=r.Component),w(re,[{key:"render",value:function(){var e=(t=this.props).freeze,t=t.children,n=this.promiseCache;if(e&&!n.promise)throw n.promise=new Promise((function(e){n.resolve=e})),n.promise;if(e)throw n.promise;return n.promise&&(n.resolve(),n.promise=void 0),s.createElement(r.Fragment,null,t)}}]),re);function re(){var e;l(this,re);for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=E(this,(e=re.__proto__||Object.getPrototypeOf(re)).call.apply(e,[this].concat(r)))).promiseCache={},E(e,e)}var ne=r.Suspense?function(e){var t=e.freeze,n=e.children;return e=e.placeholder,ee?n:s.createElement(r.Suspense,{fallback:void 0===e?null:e},s.createElement(te,{freeze:t},n))}:function(e){return e.children},oe=(O(ce,n=r.Component),ce);function ce(e){l(this,ce);var t=E(this,(ce.__proto__||Object.getPrototypeOf(ce)).call(this,e));return t.state={freeze:!1},t.freezeTimeout=null,t.shouldComponentUpdate=function(e){var r=e.freeze;return e=t.props.freeze,r!==e&&(clearTimeout(t.freezeTimeout),t.freezeTimeout=setTimeout((function(){t.setState({freeze:r})}),1e3)),!0},t.render=function(){return s.createElement(ne,{freeze:!!t.props.freeze&&t.state.freeze},v(t.props,"children"))},t.state={freeze:e.freeze},t}oe.propsTypes={freeze:o.bool.isRequired},O(ie,n=r.Component);var ae=ie;function ie(){var e,t;l(this,ie);for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t=E(this,(e=ie.__proto__||Object.getPrototypeOf(ie)).call.apply(e,[this].concat(n)))).render=function(){return v(t.props,"children")},t.shouldComponentUpdate=function(e){return e.when},E(t,e)}function ue(e){return s.createElement(oe,{freeze:!e.when},s.createElement(ae,e))}ae.propsTypes={when:o.bool.isRequired};var le=p(r.Fragment);function se(){var e;l(this,se);for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=E(this,(e=se.__proto__||Object.getPrototypeOf(se)).call.apply(e,[this].concat(r)))).cache={},E(e,e)}O(se,n=r.Component),w(se,[{key:"render",value:function(){var e,t=this,n=(_=this.props).children,o=_.render,a=_.component,i=_.className,l=_.when,h=_.behavior,f=_.cacheKey,p=_.unmount,d=_.saveScrollPosition,m=_.computedMatchForCacheRoute,y=_.multiple,_=j(_,["children","render","component","className","when","behavior","cacheKey","unmount","saveScrollPosition","computedMatchForCacheRoute","multiple"]);return!s.isValidElement(n)&&(e=n,0===s.Children.count(e))||(o=function(){return n}),m&&(_.computedMatch=m),u(y=!(y&&!le)&&y)&&(y=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:Number.MAX_VALUE;return e<t?t:r<e?r:e}(y,1)),s.createElement(c.Route,_,(function(e){function c(e){return s.createElement(Z,e,(function(t){return s.createElement(ue,{when:Y(e.match)},(function(){return Object.assign(e,{cacheLifecycles:t}),a?s.createElement(a,e):v(o||n,void 0,e)}))}))}var m=e.match,_=e.computedMatch,b=e.location,w=Y(e.match),g=b.pathname,C=b.search,O=u(y)?y:1/0,j={when:l,className:i,behavior:h,cacheKey:f,unmount:p,saveScrollPosition:d};return y&&w&&(t.cache[b=g+C]={updateTime:Date.now(),href:b,pathname:g,render:c},Object.entries(t.cache).sort((function(e,t){return e=T(e,2)[1],T(t,2)[1].updateTime-e.updateTime})).forEach((function(e,r){e=T(e,1)[0],O<=r&&delete t.cache[e]}))),y?s.createElement(r.Fragment,null,Object.entries(t.cache).map((function(t){var n=(t=T(t,2))[0],o=(t=t[1]).render,c=t.href;return t=t.pathname,s.createElement(r.Fragment,{key:n},o(R({},e,j,{cacheKey:f,pathname:t,href:c,multiple:!0,key:n,match:n===g+C?m||_:null})))}))):c(R({},e,j,{pathname:g,href:g,multiple:!1}))}))}}]),(n=se).__name="CacheRoute",n.propTypes={component:o.elementType||o.any,render:o.func,children:o.oneOfType([o.func,o.node]),computedMatchForCacheRoute:o.object,multiple:o.oneOfType([o.bool,o.number])},n.defaultProps={multiple:!1};var he=p(r.Fragment)?function(e){return e=e.children,s.createElement(r.Fragment,null,e)}:p(r.PropTypes)?function(e){return e=e.children,s.createElement("div",null,e)}:function(e){return e.children},fe=(he.displayName="SwitchFragment",p(c.__RouterContext)||p(c.useHistory)),pe=(O(de,pe=c.Switch),w(de,[{key:"render",value:function(){var e,t=(e=this.props).children,r=e.which,n=(e=this.getContext()).location,o=e.match,a=!1;return s.createElement(ue,{when:Y(o)},(function(){return s.createElement(he,null,s.Children.map(t,(function(e){if(!s.isValidElement(e))return null;var t=e.props.path||e.props.from,u=void(t=a?null:t?c.matchPath(n.pathname,R({},e.props,{path:t}),o):o);return u=r(e)?s.cloneElement(e,R({location:n,computedMatch:t},i(t)?{computedMatchForCacheRoute:C({},Q,!0)}:null)):t&&!a?s.cloneElement(e,{location:n,computedMatch:t}):null,a=a||!!t,u})))}))}}]),de);function de(){var e,t;l(this,de);for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=E(this,(e=de.__proto__||Object.getPrototypeOf(de)).call.apply(e,[this].concat(n)))).getContext=function(){var e;return fe?{location:(e=t.props).location,match:e.match}:(e=t.context.router.route,{location:t.props.location||e.location,match:e.match})},E(t,t)}fe?(pe.propTypes={children:o.node,location:o.object.isRequired,match:o.object.isRequired,which:o.func},pe=c.withRouter(pe)):(pe.contextTypes={router:o.shape({route:o.object.isRequired}).isRequired},pe.propTypes={children:o.node,location:o.object,which:o.func}),pe.defaultProps={which:function(e){return"CacheRoute"===y(e,"type.__name")}},w=pe,t.default=n,t.CacheRoute=n,t.CacheSwitch=w,t.dropByCacheKey=B,t.refreshByCacheKey=function(e){(e=y(W,[e]))&&(e instanceof Z?H(e):Object.values(e).forEach(H))},t.getCachingKeys=function(){return D().map((function(e){return T(e,1)[0]}))},t.clearCache=function(){D().forEach((function(e){return B(e=T(e,1)[0])}))},t.getCachingComponents=function(){return D().reduce((function(e,t){var r=(t=T(t,2))[0];return t=t[1],R({},e,t instanceof Z?C({},r,t):Object.entries(t).reduce((function(e,t){var n=(t=T(t,2))[0];return t=t[1],R({},e,C({},r+"."+n,t))}),{}))}),{})},t.useDidCache=b,t.useDidRecover=L,Object.defineProperty(t,"__esModule",{value:!0})}(i.exports,r,n,o,c);var u=i.exports;a.exports=u;var l=a.exports;const s=t(l);export{s as C,l as r};
